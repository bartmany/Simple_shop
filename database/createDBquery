CREATE DATABASE IF NOT EXISTS simpleshop;

USE simpleshop;

CREATE TABLE Users (
                        `id` int AUTO_INCREMENT NOT NULL,
                        `name` varchar(255) NOT NULL,
                        `email` varchar(255) NOT NULL,
                        `password` varchar(255) NOT NULL,
                        PRIMARY KEY(id))
     ENGINE=InnoDB, CHARACTER SET=utf8;

CREATE TABLE Admins (
                        `id` int AUTO_INCREMENT NOT NULL,
                        `name` varchar(255) NOT NULL,
                        `email` varchar(255) NOT NULL,
                        `password` varchar(255) NOT NULL,
                        PRIMARY KEY(id))
     ENGINE=InnoDB, CHARACTER SET=utf8;

CREATE TABLE Products (
                        `id` int AUTO_INCREMENT NOT NULL,
                        `description` varchar(2047) NOT NULL,
                        `price` decimal(10,2),
                        `quantity` decimal(10,2), 
                        PRIMARY KEY(id))
     ENGINE=InnoDB, CHARACTER SET=utf8;

CREATE TABLE Images (
                        `id` int AUTO_INCREMENT NOT NULL,
                        `product_id` int NOT NULL,
                        `src` varchar(255),
                        PRIMARY KEY(id),
                        FOREIGN KEY(product_id) REFERENCES Products(id) ON DELETE CASCADE)
     ENGINE=InnoDB, CHARACTER SET=utf8;

CREATE TABLE Messages(
                        id int AUTO_INCREMENT NOT NULL,
                        sender_id int NOT NULL,
                        reciever_id int NOT NULL,
                        opened datetime NOT NULL,
                        message text NOT NULL,
                        PRIMARY KEY(id),
                        FOREIGN KEY(sender_id) REFERENCES Admins(id) ON DELETE CASCADE,
                        FOREIGN KEY(reciever_id) REFERENCES Users(id) ON DELETE CASCADE)
     ENGINE=InnoDB, CHARACTER SET=utf8;

CREATE TABLE Orders (
                        `id` int AUTO_INCREMENT NOT NULL,
                        `user_id` int NOT NULL,
                        `status` varchar(255) NOT NULL,
                        PRIMARY KEY(id),
                        FOREIGN KEY(user_id) REFERENCES Users(id) ON DELETE CASCADE)
     ENGINE=InnoDB, CHARACTER SET=utf8;

CREATE TABLE Product_Orders (
                        `id` int AUTO_INCREMENT NOT NULL,
                        `order_id` int NOT NULL,
                        `product_id` int,
                        PRIMARY KEY(id),
                        FOREIGN KEY(order_id) REFERENCES Orders(id) ON DELETE CASCADE,
                        FOREIGN KEY(product_id) REFERENCES Products(id) ON DELETE CASCADE)
     ENGINE=InnoDB, CHARACTER SET=utf8;
 
 